{% extends "account/base.html" %}

{% load i18n %}
{% block head_title %}{% trans "Change Password" %}{% endblock %}

{% block content %}

<h1 class="text-accent-blue mb-4">
    {% if token_fail %}
        {% trans "Bad Token" %}
    {% else %}
        {% trans "Change Password" %}
    {% endif %}
</h1>

{% if token_fail %}

    {% url 'account_reset_password' as passwd_reset_url %}

    <p class="text-accent-pink">
        {% blocktrans %}
            The password reset link was invalid, possibly because it has already been used.
            Please request a <a href="{{ passwd_reset_url }}">new password reset</a>.
        {% endblocktrans %}
    </p>

{% else %}

    <form method="post" action="{{ action_url }}">
        {% csrf_token %}
        {{ redirect_field }}

        {{ form.as_p }}

        <div class="mt-3 d-flex gap-3">
            <button type="submit" name="action" class="btn btn-outline-primary">
                {% trans "Change Password" %}
            </button>

            <button type="submit"
                    form="logout-from-stage"
                    class="btn btn-outline-danger">
                {% trans "Cancel" %}
            </button>
        </div>
    </form>

{% endif %}

{% if not cancel_url %}
<form id="logout-from-stage"
      method="post"
      action="{% url 'account_logout' %}">
    {% csrf_token %}
    <input type="hidden" name="next" value="{% url 'account_login' %}">
</form>
{% endif %}

{% endblock content %}
