{% extends "account/base.html" %}
{% load static allauth i18n %}

{% block head_title %}
    {% trans "Email Addresses" %}
{% endblock head_title %}

{% block content %}
<h1 class="text-accent-blue mb-4">{% trans "Email Addresses" %}</h1>

{% if emailaddresses %}
    <p>{% trans "The following email addresses are associated with your account:" %}</p>

    {% url 'account_email' as email_url %}
    <form method="post" action="{{ email_url }}">
        {% csrf_token %}

        {% for radio in emailaddress_radios %}
            {% with emailaddress=radio.emailaddress %}
                <div class="mb-2">
                    <label for="{{ radio.id }}" class="d-flex gap-2 align-items-center">

                        <input 
                            type="radio"
                            id="{{ radio.id }}"
                            name="email"
                            value="{{ emailaddress.email }}"
                            {% if radio.checked %}checked{% endif %}
                        >

                        <span>{{ emailaddress.email }}</span>

                        {% if emailaddress.verified %}
                            <span class="badge bg-success">
                                {% translate "Verified" %}
                            </span>
                        {% else %}
                            <span class="badge" style="background-color: var(--accent-pink); color:white;">
                                {% translate "Unverified" %}
                            </span>
                        {% endif %}

                        {% if emailaddress.primary %}
                            <span class="badge" style="background-color: var(--accent-blue); color:white;">
                                {% translate "Primary" %}
                            </span>
                        {% endif %}
                    </label>
                </div>
            {% endwith %}
        {% endfor %}

        <div class="mt-3 d-flex gap-2">
            <button type="submit" name="action_primary"
                    class="btn btn-outline-primary">
                {% trans "Make Primary" %}
            </button>

            <button type="submit" name="action_send"
                    class="btn btn-outline-primary">
                {% trans "Re-send Verification" %}
            </button>

            <button type="submit" name="action_remove"
                    class="btn btn-outline-danger">
                {% trans "Remove" %}
            </button>
        </div>
    </form>

{% else %}
    {% include "account/snippets/warn_no_email.html" %}
{% endif %}

{% if can_add_email %}
    <hr class="my-4">

    <h2 class="text-accent-blue">{% trans "Add Email Address" %}</h2>

    {% url 'account_email' as action_url %}
    <form method="post" action="{{ action_url }}">
        {% csrf_token %}
        {{ form.as_p }}

        <button type="submit" name="action_add"
                class="btn btn-outline-primary">
            {% trans "Add Email" %}
        </button>
    </form>
{% endif %}
{% endblock content %}

{% block extra_body %}
<script src="{% static 'account/js/account.js' %}"></script>
<script src="{% static 'account/js/onload.js' %}"></script>

<script data-allauth-onload="allauth.account.forms.manageEmailForm" type="application/json">
{
    "i18n": {
        "confirmDelete": "{% trans 'Do you really want to remove the selected email address?' %}"
    }
}
</script>
{% endblock extra_body %}